<!-- Page 3 -->
<a name="3"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft332{font-size:15px;line-height:18px;font-family:JZXWNF+LinLibertineT;color:#000000;}
	.ft333{font-size:15px;line-height:20px;font-family:JZXWNF+LinLibertineT;color:#000000;}
-->
</style>
<div id="page3-div" style="position:relative;width:729px;height:1080px;">
<img width="729" height="1080" src="out003.png" alt="background image"/>
<p style="position:absolute;top:93px;left:69px;white-space:nowrap" class="ft316">Statically&#160;Contextualizing&#160;Large&#160;Language&#160;Models&#160;with&#160;Typed&#160;Holes</p>
<p style="position:absolute;top:93px;left:635px;white-space:nowrap" class="ft316">288:3</p>
<p style="position:absolute;top:131px;left:69px;white-space:nowrap" class="ft327">being&#160;generated)&#160;or&#160;more&#160;typically&#160;it&#160;will&#160;hallucinate&#160;plausible-but-incorrect&#160;definitions&#160;based&#160;only<br/>on&#160;the&#160;provided&#160;comment&#160;<a href="out.html#30">[80,&#160;</a><a href="out.html#31">85].</a></p>
<p style="position:absolute;top:167px;left:84px;white-space:nowrap" class="ft320">To&#160;address&#160;this&#160;problem,&#160;assistant&#160;designers&#160;use&#160;various&#160;retrieval&#160;augmented&#160;generation&#160;(RAG)</p>
<p style="position:absolute;top:185px;left:69px;white-space:nowrap" class="ft327">techniques&#160;<a href="out.html#27">[25]&#160;</a>to&#160;retrieve&#160;additional&#160;code&#160;from&#160;other&#160;files&#160;in&#160;the&#160;repository&#160;and&#160;external&#160;libraries<br/>for&#160;inclusion&#160;in&#160;the&#160;prompt.&#160;Real-world&#160;code&#160;bases&#160;often&#160;span&#160;hundreds&#160;of&#160;thousands&#160;of&#160;lines&#160;of<br/>code,&#160;so&#160;exhaustive&#160;retrieval&#160;quickly&#160;runs&#160;into&#160;scaling&#160;issues.&#160;While&#160;prompt&#160;(i.e.&#160;context)&#160;size&#160;limits<br/>continue&#160;to&#160;increase&#160;<a href="out.html#27">[21],&#160;</a>generation&#160;costs&#160;(measured&#160;in&#160;both&#160;time&#160;and&#160;energy)&#160;scale&#160;with&#160;token<br/>count&#160;<a href="out.html#28">[30].&#160;</a>These&#160;costs&#160;are&#160;substantial&#160;(because&#160;LLMs&#160;typically&#160;have&#160;billions&#160;of&#160;parameters)&#160;so<br/>token&#160;efficiency&#160;remains&#160;a&#160;critical&#160;metric&#160;<a href="out.html#30">[66].&#160;</a>Moreover,&#160;contemporary&#160;LLMs&#160;struggle&#160;to&#160;attend<br/>to&#160;relevant&#160;information&#160;and&#160;ignore&#160;irrelevant&#160;information&#160;(such&#160;as&#160;the</p>
<p style="position:absolute;top:291px;left:499px;white-space:nowrap" class="ft326">Model&#160;and&#160;Action&#160;types&#160;for</p>
<p style="position:absolute;top:311px;left:69px;white-space:nowrap" class="ft322">other&#160;GUI&#160;components)&#160;in&#160;large&#160;prompts&#160;<a href="out.html#28">[35,&#160;37,&#160;41,&#160;</a><a href="out.html#30">79].</a></p>
<p style="position:absolute;top:329px;left:84px;white-space:nowrap" class="ft320">Given&#160;these&#160;issues,&#160;assistant&#160;designers&#160;need&#160;retrieval&#160;techniques&#160;that&#160;prioritize&#160;task-relevant&#160;code.</p>
<p style="position:absolute;top:347px;left:69px;white-space:nowrap" class="ft327">For&#160;example,&#160;Copilot&#160;retrieves&#160;code&#160;from&#160;locations&#160;in&#160;other&#160;files&#160;that&#160;the&#160;developer&#160;has&#160;recently<br/>visited,&#160;based&#160;on&#160;the&#160;heuristic&#160;that&#160;these&#160;are&#160;likely&#160;to&#160;be&#160;task-relevant&#160;<a href="out.html#30">[71].&#160;</a>Another&#160;prominent<br/>retrieval&#160;strategy,&#160;which&#160;we&#160;will&#160;refer&#160;to&#160;as&#160;vector&#160;retrieval,&#160;involves&#160;performing&#160;a&#160;vector&#160;search<br/>across&#160;the&#160;repository&#160;(and&#160;perhaps&#160;beyond)&#160;to&#160;retrieve&#160;code&#160;similar&#160;to&#160;the&#160;code&#160;in&#160;the&#160;cursor</p>
<p style="position:absolute;top:418px;left:68px;white-space:nowrap" class="ft320">window&#160;<a href="out.html#29">[44,&#160;</a><a href="out.html#30">82,&#160;83],&#160;</a>as&#160;measured&#160;by&#160;a&#160;learned&#160;vector&#160;similarity&#160;metric&#160;<a href="out.html#28">[36,&#160;</a><a href="out.html#29">49].&#160;</a>This&#160;relies&#160;on&#160;the</p>
<p style="position:absolute;top:436px;left:69px;white-space:nowrap" class="ft327">heuristic&#160;that&#160;lexically&#160;similar&#160;code&#160;is&#160;likely&#160;to&#160;be&#160;task-relevant&#160;code.&#160;In&#160;the&#160;example&#160;above,&#160;since<br/>the&#160;type&#160;names</p>
<p style="position:absolute;top:452px;left:166px;white-space:nowrap" class="ft326">Model&#160;and&#160;Action&#160;appear&#160;explicitly&#160;in&#160;the&#160;cursor&#160;window,&#160;this&#160;approach&#160;may&#160;find</p>
<p style="position:absolute;top:472px;left:69px;white-space:nowrap" class="ft320">their&#160;definitions.&#160;However,&#160;it&#160;may&#160;also&#160;find&#160;irrelevant&#160;definitions&#160;of&#160;other&#160;types&#160;named</p>
<p style="position:absolute;top:470px;left:600px;white-space:nowrap" class="ft326">Model&#160;and</p>
<p style="position:absolute;top:488px;left:68px;white-space:nowrap" class="ft327">Action&#160;and&#160;other&#160;implementations&#160;of&#160;update,&#160;e.g.&#160;those&#160;from&#160;other&#160;GUI&#160;components&#160;in&#160;this&#160;or&#160;other<br/>applications.&#160;It&#160;may&#160;also&#160;be&#160;less&#160;effective&#160;when&#160;the&#160;task-relevant&#160;definitions&#160;are&#160;not&#160;named&#160;explicitly,<br/>e.g.&#160;if&#160;the&#160;developer&#160;is&#160;later&#160;writing&#160;a&#160;call&#160;to</p>
<p style="position:absolute;top:524px;left:339px;white-space:nowrap" class="ft326">update,&#160;the&#160;fact&#160;that&#160;the&#160;relevant&#160;types&#160;are&#160;Model&#160;and</p>
<p style="position:absolute;top:542px;left:68px;white-space:nowrap" class="ft326">Action&#160;requires&#160;reasoning&#160;about&#160;the&#160;type&#160;signature&#160;of&#160;the&#160;update&#160;function.</p>
<p style="position:absolute;top:562px;left:84px;white-space:nowrap" class="ft320">These&#160;retrieval&#160;approaches&#160;are&#160;language-agnostic,&#160;treating&#160;source&#160;code&#160;as&#160;a&#160;sequence&#160;of&#160;tokens</p>
<p style="position:absolute;top:580px;left:69px;white-space:nowrap" class="ft327">like&#160;any&#160;other,&#160;so&#160;they&#160;must&#160;necessarily&#160;deploy&#160;imprecise&#160;heuristics.&#160;In&#160;this&#160;paper,&#160;we&#160;instead<br/>consider&#160;language-aware&#160;approaches&#160;that&#160;take&#160;advantage&#160;of&#160;the&#160;fact&#160;that&#160;in&#160;many&#160;languages,&#160;code<br/>is&#160;governed&#160;by&#160;a&#160;rich&#160;type&#160;and&#160;binding&#160;discipline&#160;determined&#160;by&#160;a&#160;static&#160;semantics&#160;<a href="out.html#28">[28,&#160;</a><a href="out.html#29">62].&#160;</a>To<br/>retrieve&#160;relevant&#160;semantic&#160;information&#160;and&#160;analyze&#160;candidate&#160;code&#160;completions,&#160;we&#160;rely&#160;on&#160;a<br/>modern&#160;language&#160;server&#160;<a href="out.html#27">[10,&#160;13]&#160;</a>to&#160;provide&#160;various&#160;language&#160;services,&#160;namely&#160;type&#160;reporting,&#160;typing<br/>context&#160;search,&#160;and&#160;error&#160;reporting.&#160;Integrated&#160;development&#160;environments&#160;(IDEs)&#160;interact&#160;with<br/>these&#160;services&#160;to&#160;drive&#160;various&#160;human-facing&#160;affordances&#160;such&#160;as&#160;type&#160;hints&#160;and&#160;hover&#160;messages.<br/>Here&#160;we&#160;investigate&#160;the&#160;hypothesis&#160;that&#160;LLM&#160;code&#160;completion&#160;can&#160;also&#160;benefit&#160;from&#160;interactions</p>
<p style="position:absolute;top:723px;left:68px;white-space:nowrap" class="ft320">with&#160;language&#160;services.&#160;Put&#160;pithily,&#160;we&#160;hypothesize&#160;that&#160;AIs&#160;need&#160;IDEs,&#160;too.</p>
<p style="position:absolute;top:741px;left:84px;white-space:nowrap" class="ft320">We&#160;investigate&#160;two&#160;language-aware&#160;approaches&#160;independently&#160;and&#160;in&#160;combination:</p>
<p style="position:absolute;top:786px;left:84px;white-space:nowrap" class="ft322">Static&#160;Retrieval.&#160;The&#160;first&#160;approach&#160;we&#160;consider&#160;<a href="out.html#6">(section&#160;2)&#160;</a>is&#160;static&#160;retrieval,&#160;where&#160;the&#160;language</p>
<p style="position:absolute;top:804px;left:69px;white-space:nowrap" class="ft320">server&#160;is&#160;tasked&#160;to&#160;(1)&#160;determine&#160;the&#160;type&#160;and&#160;typing&#160;context&#160;of&#160;the&#160;“hole”&#160;(implicit&#160;in&#160;the</p>
<p style="position:absolute;top:802px;left:620px;white-space:nowrap" class="ft326">update</p>
<p style="position:absolute;top:822px;left:69px;white-space:nowrap" class="ft327">sketch&#160;above)&#160;at&#160;the&#160;cursor,&#160;and&#160;(2)&#160;transitively&#160;retrieve&#160;semantically&#160;relevant&#160;type&#160;definitions&#160;and<br/>function&#160;headers,&#160;from&#160;wherever&#160;they&#160;might&#160;appear,&#160;for&#160;inclusion&#160;in&#160;the&#160;prompt.</p>
<p style="position:absolute;top:858px;left:84px;white-space:nowrap" class="ft320">In&#160;the</p>
<p style="position:absolute;top:855px;left:122px;white-space:nowrap" class="ft326">update&#160;example,&#160;the&#160;hole&#160;that&#160;the&#160;language&#160;server&#160;inserts&#160;(either&#160;implicitly&#160;or&#160;explicitly)&#160;at</p>
<p style="position:absolute;top:876px;left:69px;white-space:nowrap" class="ft320">the&#160;cursor&#160;is&#160;of&#160;type</p>
<p style="position:absolute;top:873px;left:194px;white-space:nowrap" class="ft326">Model&#160;(because&#160;it&#160;is&#160;in&#160;the&#160;body&#160;of&#160;the&#160;update&#160;function,&#160;which&#160;has&#160;return&#160;type</p>
<p style="position:absolute;top:891px;left:69px;white-space:nowrap" class="ft333">Model),&#160;and&#160;the&#160;local&#160;typing&#160;context&#160;includes&#160;the&#160;argument&#160;action&#160;:&#160;Action,&#160;so&#160;the&#160;language&#160;server<br/>can&#160;look&#160;up&#160;the&#160;definitions&#160;of&#160;the</p>
<p style="position:absolute;top:909px;left:277px;white-space:nowrap" class="ft326">Model&#160;and&#160;Action&#160;types.&#160;These&#160;types&#160;might&#160;themselves&#160;refer&#160;to</p>
<p style="position:absolute;top:929px;left:69px;white-space:nowrap" class="ft327">other&#160;types,&#160;so&#160;we&#160;can&#160;transitively&#160;continue&#160;type&#160;retrieval.&#160;We&#160;can&#160;also&#160;retrieve&#160;information&#160;about<br/>relevant&#160;helper&#160;functions&#160;in&#160;the&#160;typing&#160;context,&#160;e.g.&#160;those&#160;that&#160;operate&#160;on&#160;the&#160;types&#160;that&#160;have&#160;been<br/>looked&#160;up,&#160;continuing&#160;transitively&#160;up&#160;to&#160;a&#160;token&#160;limit.</p>
<p style="position:absolute;top:1012px;left:203px;white-space:nowrap" class="ft39">Proc.&#160;ACM&#160;Program.&#160;Lang.,&#160;Vol.&#160;8,&#160;No.&#160;OOPSLA2,&#160;Article&#160;288.&#160;Publication&#160;date:&#160;October&#160;2024.</p>
</div>
