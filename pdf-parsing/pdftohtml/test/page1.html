<!-- Page 1 -->
<a name="1"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft10{font-size:22px;font-family:GAQDOW+LinBiolinumTB;color:#000000;}
	.ft11{font-size:16px;font-family:WVOPFG+LinBiolinumT;color:#005595;}
	.ft12{font-size:16px;font-family:WVOPFG+LinBiolinumT;color:#000000;}
	.ft13{font-size:13px;font-family:JZXWNF+LinLibertineT;color:#000000;}
	.ft14{font-size:13px;font-family:PFQUFB+LinLibertineTB;color:#000000;}
	.ft15{font-size:13px;font-family:NVCMIJ+txsys;color:#000000;}
	.ft16{font-size:13px;font-family:BQBJUC+LinLibertineTI;color:#000000;}
	.ft17{font-size:13px;font-family:JZXWNF+LinLibertineT;color:#781d7d;}
	.ft18{font-size:13px;font-family:JZXWNF+LinLibertineT;color:#005595;}
	.ft19{font-size:12px;font-family:JZXWNF+LinLibertineT;color:#000000;}
	.ft110{font-size:12px;font-family:JZXWNF+LinLibertineT;color:#005595;}
	.ft111{font-size:12px;font-family:IMUZXN+LinLibertineT;color:#000000;}
	.ft112{font-size:13px;line-height:19px;font-family:JZXWNF+LinLibertineT;color:#000000;}
	.ft113{font-size:13px;line-height:16px;font-family:JZXWNF+LinLibertineT;color:#000000;}
	.ft114{font-size:13px;line-height:16px;font-family:PFQUFB+LinLibertineTB;color:#000000;}
	.ft115{font-size:12px;line-height:14px;font-family:JZXWNF+LinLibertineT;color:#000000;}
-->
</style>
<div id="page1-div" style="position:relative;width:729px;height:1080px;">
<img width="729" height="1080" src="out001.png" alt="background image"/>
<p style="position:absolute;top:127px;left:69px;white-space:nowrap" class="ft10">Statically&#160;Contextualizing&#160;Large&#160;Language&#160;Models&#160;with</p>
<p style="position:absolute;top:152px;left:68px;white-space:nowrap" class="ft10">Typed&#160;Holes</p>
<p style="position:absolute;top:191px;left:68px;white-space:nowrap" class="ft112"><a href="HTTPS://ORCID.ORG/0000-0001-6938-7379">ANDREW&#160;BLINN,&#160;</a>University&#160;of&#160;Michigan,&#160;USA<br/><a href="HTTPS://ORCID.ORG/0009-0005-6860-039X">XIANG&#160;LI,&#160;</a>University&#160;of&#160;Michigan,&#160;USA<br/><a href="HTTPS://ORCID.ORG/0009-0005-0820-9532">JUNE&#160;HYUNG&#160;KIM,&#160;</a>University&#160;of&#160;Michigan,&#160;USA</p>
<p style="position:absolute;top:249px;left:69px;white-space:nowrap" class="ft11"><a href="HTTPS://ORCID.ORG/0000-0003-4502-7971">CYRUS&#160;OMAR,&#160;</a>University&#160;of&#160;Michigan,&#160;USA</p>
<p style="position:absolute;top:277px;left:69px;white-space:nowrap" class="ft113">Large&#160;language&#160;models&#160;(LLMs)&#160;have&#160;reshaped&#160;the&#160;landscape&#160;of&#160;program&#160;synthesis.&#160;However,&#160;contemporary<br/>LLM-based&#160;code&#160;completion&#160;systems&#160;often&#160;hallucinate&#160;broken&#160;code&#160;because&#160;they&#160;lack&#160;appropriate&#160;code&#160;context,<br/>particularly&#160;when&#160;working&#160;with&#160;definitions&#160;that&#160;are&#160;neither&#160;in&#160;the&#160;training&#160;data&#160;nor&#160;near&#160;the&#160;cursor.&#160;This<br/>paper&#160;demonstrates&#160;that&#160;tighter&#160;integration&#160;with&#160;the&#160;type&#160;and&#160;binding&#160;structure&#160;of&#160;the&#160;programming&#160;language<br/>in&#160;use,&#160;as&#160;exposed&#160;by&#160;its&#160;language&#160;server,&#160;can&#160;help&#160;address&#160;this&#160;contextualization&#160;problem&#160;in&#160;a&#160;token-efficient<br/>manner.&#160;In&#160;short,&#160;we&#160;contend&#160;that&#160;AIs&#160;need&#160;IDEs,&#160;too!&#160;In&#160;particular,&#160;we&#160;integrate&#160;LLM&#160;code&#160;generation&#160;into<br/>the&#160;Hazel&#160;live&#160;program&#160;sketching&#160;environment.&#160;The&#160;Hazel&#160;Language&#160;Server&#160;is&#160;able&#160;to&#160;identify&#160;the&#160;type&#160;and<br/>typing&#160;context&#160;of&#160;the&#160;hole&#160;that&#160;the&#160;programmer&#160;is&#160;filling,&#160;with&#160;Hazel’s&#160;total&#160;syntax&#160;and&#160;type&#160;error&#160;correction<br/>ensuring&#160;that&#160;a&#160;meaningful&#160;program&#160;sketch&#160;is&#160;available&#160;whenever&#160;the&#160;developer&#160;requests&#160;a&#160;completion.&#160;This<br/>allows&#160;the&#160;system&#160;to&#160;prompt&#160;the&#160;LLM&#160;with&#160;codebase-wide&#160;contextual&#160;information&#160;that&#160;is&#160;not&#160;lexically&#160;local<br/>to&#160;the&#160;cursor,&#160;nor&#160;necessarily&#160;in&#160;the&#160;same&#160;file,&#160;but&#160;that&#160;is&#160;likely&#160;to&#160;be&#160;semantically&#160;local&#160;to&#160;the&#160;developer’s<br/>goal.&#160;Completions&#160;synthesized&#160;by&#160;the&#160;LLM&#160;are&#160;then&#160;iteratively&#160;refined&#160;via&#160;further&#160;dialog&#160;with&#160;the&#160;language<br/>server,&#160;which&#160;provides&#160;error&#160;localization&#160;and&#160;error&#160;messages.&#160;To&#160;evaluate&#160;these&#160;techniques,&#160;we&#160;introduce<br/>MVUBench,&#160;a&#160;dataset&#160;of&#160;model-view-update&#160;(MVU)&#160;web&#160;applications&#160;with&#160;accompanying&#160;unit&#160;tests&#160;that&#160;have<br/>been&#160;written&#160;from&#160;scratch&#160;to&#160;avoid&#160;data&#160;contamination,&#160;and&#160;that&#160;can&#160;easily&#160;be&#160;ported&#160;to&#160;new&#160;languages&#160;because<br/>they&#160;do&#160;not&#160;have&#160;large&#160;external&#160;library&#160;dependencies.&#160;These&#160;applications&#160;serve&#160;as&#160;challenge&#160;problems&#160;due&#160;to<br/>their&#160;extensive&#160;reliance&#160;on&#160;application-specific&#160;data&#160;structures.&#160;Through&#160;an&#160;ablation&#160;study,&#160;we&#160;examine&#160;the<br/>impact&#160;of&#160;contextualization&#160;with&#160;type&#160;definitions,&#160;function&#160;headers,&#160;and&#160;errors&#160;messages,&#160;individually&#160;and&#160;in<br/>combination.&#160;We&#160;find&#160;that&#160;contextualization&#160;with&#160;type&#160;definitions&#160;is&#160;particularly&#160;impactful.&#160;After&#160;introducing<br/>our&#160;ideas&#160;in&#160;the&#160;context&#160;of&#160;Hazel,&#160;a&#160;low-resource&#160;language,&#160;we&#160;duplicate&#160;our&#160;techniques&#160;and&#160;port&#160;MVUBench<br/>to&#160;TypeScript&#160;in&#160;order&#160;to&#160;validate&#160;the&#160;applicability&#160;of&#160;these&#160;methods&#160;to&#160;higher-resource&#160;mainstream&#160;languages.<br/>Finally,&#160;we&#160;outline&#160;ChatLSP,&#160;a&#160;conservative&#160;extension&#160;to&#160;the&#160;Language&#160;Server&#160;Protocol&#160;(LSP)&#160;that&#160;language<br/>servers&#160;can&#160;implement&#160;to&#160;expose&#160;capabilities&#160;that&#160;AI&#160;code&#160;completion&#160;systems&#160;of&#160;various&#160;designs&#160;can&#160;use&#160;to<br/>incorporate&#160;static&#160;context&#160;when&#160;generating&#160;prompts&#160;for&#160;an&#160;LLM.</p>
<p style="position:absolute;top:680px;left:69px;white-space:nowrap" class="ft114">CCS&#160;Concepts:&#160;•&#160;Software&#160;and&#160;its&#160;engineering&#160;→&#160;Software&#160;creation&#160;and&#160;management;&#160;•&#160;Theory&#160;of<br/>computation&#160;→&#160;Type&#160;structures.</p>
<p style="position:absolute;top:721px;left:68px;white-space:nowrap" class="ft13">Additional&#160;Key&#160;Words&#160;and&#160;Phrases:&#160;Large&#160;Language&#160;Models,&#160;Program&#160;Synthesis,&#160;Program&#160;Repair</p>
<p style="position:absolute;top:746px;left:68px;white-space:nowrap" class="ft114">ACM&#160;Reference&#160;Format:<br/>Andrew&#160;Blinn,&#160;Xiang&#160;Li,&#160;June&#160;Hyung&#160;Kim,&#160;and&#160;Cyrus&#160;Omar.&#160;2024.&#160;Statically&#160;Contextualizing&#160;Large&#160;Language</p>
<p style="position:absolute;top:779px;left:69px;white-space:nowrap" class="ft113">Models&#160;with&#160;Typed&#160;Holes.&#160;Proc.&#160;ACM&#160;Program.&#160;Lang.&#160;8,&#160;OOPSLA2,&#160;Article&#160;288&#160;(October&#160;2024),&#160;<a href="out.html#31">31&#160;</a>pages.<br/><a href="https://doi.org/10.1145/3689728">https://doi.org/10.1145/3689728</a></p>
<p style="position:absolute;top:825px;left:69px;white-space:nowrap" class="ft115">Authors’&#160;Contact&#160;Information:&#160;<a href="https://orcid.org/0000-0001-6938-7379">Andrew&#160;Blinn,&#160;</a>University&#160;of&#160;Michigan,&#160;Ann&#160;Arbor,&#160;USA,&#160;blinnand@umich.edu;&#160;<a href="https://orcid.org/0009-0005-6860-039X">Xiang&#160;Li,<br/></a>University&#160;of&#160;Michigan,&#160;Ann&#160;Arbor,&#160;USA,&#160;xkevli@umich.edu;&#160;<a href="https://orcid.org/0009-0005-0820-9532">June&#160;Hyung&#160;Kim,&#160;</a>University&#160;of&#160;Michigan,&#160;Ann&#160;Arbor,&#160;USA,<br/>jpoly@umich.edu;&#160;<a href="https://orcid.org/0000-0003-4502-7971">Cyrus&#160;Omar,&#160;</a>University&#160;of&#160;Michigan,&#160;Ann&#160;Arbor,&#160;USA,&#160;comar@umich.edu.</p>
<p style="position:absolute;top:946px;left:68px;white-space:nowrap" class="ft19">©&#160;2024&#160;Copyright&#160;held&#160;by&#160;the&#160;owner/author(s).</p>
<p style="position:absolute;top:961px;left:68px;white-space:nowrap" class="ft19">ACM&#160;2475-1421/2024/10-ART288</p>
<p style="position:absolute;top:976px;left:69px;white-space:nowrap" class="ft110"><a href="https://doi.org/10.1145/3689728">https://doi.org/10.1145/3689728</a></p>
<p style="position:absolute;top:1012px;left:203px;white-space:nowrap" class="ft19">Proc.&#160;ACM&#160;Program.&#160;Lang.,&#160;Vol.&#160;8,&#160;No.&#160;OOPSLA2,&#160;Article&#160;288.&#160;Publication&#160;date:&#160;October&#160;2024.</p>
<p style="position:absolute;top:928px;left:69px;white-space:nowrap" class="ft111"><a href="https://creativecommons.org/licenses/by/4.0/">This&#160;work&#160;is&#160;licensed&#160;under&#160;a&#160;Creative&#160;Commons&#160;Attribution&#160;4.0&#160;International&#160;License.</a></p>
</div>
